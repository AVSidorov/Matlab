function [Gnr,Gr]=Gaunt(Te,Ew);
% Te ev
% Ew energy point


% 1eV=11604.5K=1.6021892e-19J=2.4179696e14Hz
% 1erg=10e-7J
% h=6.6260755e-34J*s
% k=1.380662e-23J/K
% Ry=13.606eV
%
% 1.426e-27*Gnr(gamma^2,u)*ne*ni*Z^2*T^1/2*exp(-u)*du erg*s^-1*cm^-3
% u=hw/kT gamma^2=Z^2*Ry/kT

Ry=13.606;
u=Ew/Te;
Gamma2=Ry/Te;

t=(log10(Te*11604.5)-7.25)/1.25;
U=(log10(u)+1.5)/2.5;
R=(log10(Gamma2)+0.5)/2.5;

Aij=[2.42979,-2.86499,0.499579,0.343156,-0.0418944,-0.0568063,0.174588,0.0268556,-0.153561,-0.0150817,0.0448156;
    -0.0188711,-0.216925,-0.241059,0.180971,0.448744,-0.195323,-0.253964,0.300024,-0.00683477,-0.152541,0.0391975;
    0.00934182,0.186384,0.121854,-0.137451,-0.82336,-0.472693,2.98602,0.955789,-3.84957,-0.478813,1.61382;
    0.0912597,-0.134722,-0.275406,-0.852425,0.94565,3.68253,-1.75533,-4.88239,1.57378,2.10176,-0.521118;
    -0.102245,-0.446492,0.257659,1.11846,4.93886,2.22436,-21.2164,-6.02085,27.3997,3.25013,-11.3785;
    -0.15204,0.290882,0.968053,2.00368,-4.34255,-9.48579,7.65932,13.038,-6.03848,-5.70148,1.76429;
    0.137061,1.10173,-0.555546,-2.24507,-11.9797,-6.40743,51.665,15.6067,-66.915,-8.23744,27.8509;
    0.198974,-0.300431,-1.23622,-2.22406,5.49768,10.3009,-9.2422,-14.1964,6.77552,6.24736,-1.79388;
    -0.0854105,-1.19625,0.417137,2.10596,12.9195,7.30422,-54.355,-16.8713,70.078,8.79718,-29.1277;
    -0.0826964,0.10968,0.534604,0.894099,-2.30457,-4.01604,3.69866,5.51504,-2.53101,-2.42607,0.607045;
    0.0213046,0.458548,-0.106446,-0.752781,-5.00532,-2.81808,20.5954,6.38161,-26.4212,-3.30777,10.9661];
% tic;
Gr=0;
if (log10(Te*11604.5)>=6.0)&(log10(Te*11604.5)<=8.5)&(log10(u)>=-4.0)&(log10(u)<=1.0)
    for i=0:10
        for j=0:10
            Gr=Gr+Aij(i+1,j+1)*t^i*U^j;
        end;
    end;
end;
% toc;
Bij=[2.31448,-2.39863,0.979187,0.45369,-0.169366,-0.430246,-0.384721,0.107579,0.378713,0.0273831,-0.106087;
    -0.582308,0.945299,0.750594,0.0833913,0.36995,0.85494,-0.253707,-1.46431,-0.603851,0.560237,0.361029;
    -0.769314,0.190311,-0.388671,-1.26175,-1.79261,2.11206,6.98574,0.564434,-6.05501,-1.02473,1.64915;
    0.20912,-0.063427,-0.213061,-0.226219,-2.86365,-7.69346,-2.28229,11.3788,8.47077,-4.33454,-4.10317;
    0.847001,0.182172,0.396012,4.08453,10.1333,-6.40153,-31.4652,-3.86629,27.2361,4.91736,-7.45031;
    -0.121671,-0.187775,-0.542449,-1.32846,4.46956,20.3609,11.1697,-28.8967,-26.0411,11.1268,12.0846;
    -0.767073,-0.0470394,0.0976439,-7.60194,-21.7329,11.1517,63.5508,7.89505,-55.6577,-9.73728,15.4684;
    0.030137,0.244838,0.736601,2.14229,-3.24693,-21.8736,-14.5136,30.7839,30.0594,-11.9819,-13.795;
    0.440477,-0.141621,-0.524374,6.73369,20.6793,-9.63661,-59.0074,-7.06822,52.2275,8.78611,-14.7207;
    0.00512129,-0.0959773,-0.295736,-0.946625,0.939673,8.37046,6.0402,-11.7635,-11.9353,4.61643,5.46132;
    -0.112455,0.0839735,0.264128,-2.26435,-7.24494,3.22187,20.4415,2.34034,-18.2417,-2.96404,5.19706];
Gnr=0;
if (log10(Gamma2)>=-3.0)&(log10(Gamma2)<=2)&(log10(u)>=-4.0)&(log10(u)<=1.0)
    for i=0:10
        for j=0:10
            Gnr=Gnr+Bij(i+1,j+1)*R^i*U^j;
        end;
    end;
end;
